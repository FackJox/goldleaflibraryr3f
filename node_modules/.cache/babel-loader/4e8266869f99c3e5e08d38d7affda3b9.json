{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getProductionDslName = exports.isBranchingProd = exports.isOptionalProd = exports.isSequenceProd = void 0;\nvar some_1 = __importDefault(require(\"lodash/some\"));\nvar every_1 = __importDefault(require(\"lodash/every\"));\nvar includes_1 = __importDefault(require(\"lodash/includes\"));\nvar model_1 = require(\"./model\");\nfunction isSequenceProd(prod) {\n  return prod instanceof model_1.Alternative || prod instanceof model_1.Option || prod instanceof model_1.Repetition || prod instanceof model_1.RepetitionMandatory || prod instanceof model_1.RepetitionMandatoryWithSeparator || prod instanceof model_1.RepetitionWithSeparator || prod instanceof model_1.Terminal || prod instanceof model_1.Rule;\n}\nexports.isSequenceProd = isSequenceProd;\nfunction isOptionalProd(prod, alreadyVisited) {\n  if (alreadyVisited === void 0) {\n    alreadyVisited = [];\n  }\n  var isDirectlyOptional = prod instanceof model_1.Option || prod instanceof model_1.Repetition || prod instanceof model_1.RepetitionWithSeparator;\n  if (isDirectlyOptional) {\n    return true;\n  }\n  // note that this can cause infinite loop if one optional empty TOP production has a cyclic dependency with another\n  // empty optional top rule\n  // may be indirectly optional ((A?B?C?) | (D?E?F?))\n  if (prod instanceof model_1.Alternation) {\n    // for OR its enough for just one of the alternatives to be optional\n    return (0, some_1.default)(prod.definition, function (subProd) {\n      return isOptionalProd(subProd, alreadyVisited);\n    });\n  } else if (prod instanceof model_1.NonTerminal && (0, includes_1.default)(alreadyVisited, prod)) {\n    // avoiding stack overflow due to infinite recursion\n    return false;\n  } else if (prod instanceof model_1.AbstractProduction) {\n    if (prod instanceof model_1.NonTerminal) {\n      alreadyVisited.push(prod);\n    }\n    return (0, every_1.default)(prod.definition, function (subProd) {\n      return isOptionalProd(subProd, alreadyVisited);\n    });\n  } else {\n    return false;\n  }\n}\nexports.isOptionalProd = isOptionalProd;\nfunction isBranchingProd(prod) {\n  return prod instanceof model_1.Alternation;\n}\nexports.isBranchingProd = isBranchingProd;\nfunction getProductionDslName(prod) {\n  /* istanbul ignore else */\n  if (prod instanceof model_1.NonTerminal) {\n    return \"SUBRULE\";\n  } else if (prod instanceof model_1.Option) {\n    return \"OPTION\";\n  } else if (prod instanceof model_1.Alternation) {\n    return \"OR\";\n  } else if (prod instanceof model_1.RepetitionMandatory) {\n    return \"AT_LEAST_ONE\";\n  } else if (prod instanceof model_1.RepetitionMandatoryWithSeparator) {\n    return \"AT_LEAST_ONE_SEP\";\n  } else if (prod instanceof model_1.RepetitionWithSeparator) {\n    return \"MANY_SEP\";\n  } else if (prod instanceof model_1.Repetition) {\n    return \"MANY\";\n  } else if (prod instanceof model_1.Terminal) {\n    return \"CONSUME\";\n  } else {\n    throw Error(\"non exhaustive match\");\n  }\n}\nexports.getProductionDslName = getProductionDslName;","map":{"version":3,"sources":["../../src/helpers.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getProductionDslName = exports.isBranchingProd = exports.isOptionalProd = exports.isSequenceProd = void 0;\nvar some_1 = __importDefault(require(\"lodash/some\"));\nvar every_1 = __importDefault(require(\"lodash/every\"));\nvar includes_1 = __importDefault(require(\"lodash/includes\"));\nvar model_1 = require(\"./model\");\nfunction isSequenceProd(prod) {\n    return (prod instanceof model_1.Alternative ||\n        prod instanceof model_1.Option ||\n        prod instanceof model_1.Repetition ||\n        prod instanceof model_1.RepetitionMandatory ||\n        prod instanceof model_1.RepetitionMandatoryWithSeparator ||\n        prod instanceof model_1.RepetitionWithSeparator ||\n        prod instanceof model_1.Terminal ||\n        prod instanceof model_1.Rule);\n}\nexports.isSequenceProd = isSequenceProd;\nfunction isOptionalProd(prod, alreadyVisited) {\n    if (alreadyVisited === void 0) { alreadyVisited = []; }\n    var isDirectlyOptional = prod instanceof model_1.Option ||\n        prod instanceof model_1.Repetition ||\n        prod instanceof model_1.RepetitionWithSeparator;\n    if (isDirectlyOptional) {\n        return true;\n    }\n    // note that this can cause infinite loop if one optional empty TOP production has a cyclic dependency with another\n    // empty optional top rule\n    // may be indirectly optional ((A?B?C?) | (D?E?F?))\n    if (prod instanceof model_1.Alternation) {\n        // for OR its enough for just one of the alternatives to be optional\n        return (0, some_1.default)(prod.definition, function (subProd) {\n            return isOptionalProd(subProd, alreadyVisited);\n        });\n    }\n    else if (prod instanceof model_1.NonTerminal && (0, includes_1.default)(alreadyVisited, prod)) {\n        // avoiding stack overflow due to infinite recursion\n        return false;\n    }\n    else if (prod instanceof model_1.AbstractProduction) {\n        if (prod instanceof model_1.NonTerminal) {\n            alreadyVisited.push(prod);\n        }\n        return (0, every_1.default)(prod.definition, function (subProd) {\n            return isOptionalProd(subProd, alreadyVisited);\n        });\n    }\n    else {\n        return false;\n    }\n}\nexports.isOptionalProd = isOptionalProd;\nfunction isBranchingProd(prod) {\n    return prod instanceof model_1.Alternation;\n}\nexports.isBranchingProd = isBranchingProd;\nfunction getProductionDslName(prod) {\n    /* istanbul ignore else */\n    if (prod instanceof model_1.NonTerminal) {\n        return \"SUBRULE\";\n    }\n    else if (prod instanceof model_1.Option) {\n        return \"OPTION\";\n    }\n    else if (prod instanceof model_1.Alternation) {\n        return \"OR\";\n    }\n    else if (prod instanceof model_1.RepetitionMandatory) {\n        return \"AT_LEAST_ONE\";\n    }\n    else if (prod instanceof model_1.RepetitionMandatoryWithSeparator) {\n        return \"AT_LEAST_ONE_SEP\";\n    }\n    else if (prod instanceof model_1.RepetitionWithSeparator) {\n        return \"MANY_SEP\";\n    }\n    else if (prod instanceof model_1.Repetition) {\n        return \"MANY\";\n    }\n    else if (prod instanceof model_1.Terminal) {\n        return \"CONSUME\";\n    }\n    else {\n        throw Error(\"non exhaustive match\");\n    }\n}\nexports.getProductionDslName = getProductionDslName;\n//# sourceMappingURL=helpers.js.map"]},"metadata":{},"sourceType":"script"}